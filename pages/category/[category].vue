<template>
    <section>
        <h1> Categoría {{ category }}</h1>
        <div class="total-products">
            <p>Total: {{ totalProducts }}</p>
        </div>
        <div class="product-list">
            <article v-for="(product, index) in products" :key="index">
                <v-card width="330" height="480" variant="text">
                    <v-img contain height="235" :src="product.photoUrl"></v-img>
                    <v-card-item>
                        <v-card-title>{{ product.title }}</v-card-title>
                        <v-card-subtitle>
                            <span>{{ product.brand }}</span>
                        </v-card-subtitle>
                        <div class="description">
                            {{ product.description }}
                        </div>
                          <div class="rating-price">
                            <v-rating :model-value="product.rating" color="amber" density="compact" half-increments readonly
                                size="small"></v-rating>
                            <p class="price"> {{ product.price }}</p>
                        </div>
                    </v-card-item>
                    <v-card-actions>
                        <v-btn color="primary" class="flex-grow-1" variant="flat" height="48">
                            Añadir al carrito
                        </v-btn>
                    </v-card-actions>
                </v-card>
            </article>
        </div>
    </section>
</template>

<script setup lang="ts">

const route = useRoute();
const category = route.params.category as string;
const { products, totalProducts, getProductsByCategory } = useProduct();
await getProductsByCategory(category);

</script>

<style lang="scss" scoped>
section {
    padding: 50px;

    h1 {
        font-size: 2rem;
    }

    .total-products {
        font-size: 1.2rem;
        margin-bottom: 1.5rem;
    }


    .product-list {
        display: flex;
        flex-wrap: wrap;
        gap: 2rem;

        .description {
            display: -webkit-box;
            -webkit-line-clamp: 2; 
                    line-clamp: 2;
            -webkit-box-orient: vertical;
            text-overflow: ellipsis;
            overflow: hidden;
            font-size: 0.9rem;
            height: 45px;
            margin: 0.8rem 0; 
        }

        .rating-price {
            display: flex;
            justify-content: space-between;
            align-content: center;
        }

        .price {
            font-size: 1.4rem;
        }
    }
}
</style>
